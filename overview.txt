haproxy bind :80, geen 443/ssl lokaal
-> naar varnish:81
varnish bind :81
apache :8080

configs zie ansible/playbooks-v2/cloudants/ha-web

haproxy:80 -> varnish01:81, varnish02:81, varnish03:81

varnish01:81
apache01:8080

varnish02:81
apache02:8080

varnish03:81
apache03:8080

hub.docker.com/_/haproxy
hub.docker.com/_/varnish
hub.docker.com/_/php:7.4-apache

backend bk_ssl
    mode http
    redirect scheme https if !{ ssl_fc }
    server varnish01 varnish01:81
    server varnish02 varnish02:81
    server varnish03 varnish03:81